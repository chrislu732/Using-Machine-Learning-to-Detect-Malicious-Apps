# Using Machine Learning to Detect Malicious Apps

## Introduction
A tool to detect Android malware based on static analysis, which takes into account the static information of the software, including permissions and API calls. In order to identify different types of malware, use clustering algorithm to improve the classification ability of the model. First, it uses the Androguard to extract static information from APK files, including permissions requested and API calls, Secondly, in order to avoid over-fitting and too much running time, use SVM-RFE algorithm to reduce the dimension of input data, then use k-means algorithm to cluster the data to improve the accuracy of system classification. To determine the number of clusters, singular value decomposition (SVD) is chosen. Finally, several classification algorithms are used for training independent classifier for each cluster generated by the system. These classification algorithms include KNN algorithm, SVM algorithm, random forest algorithm and decision tree algorithm. When detecting an unknown application, it first determine the cluster to which it belongs, and then use the pre-trained classifier of this cluster to predict whether it is malware.

## Description
* __apktomatrix.py__: 
extract permissions and APIs from apk files and serialize them in a file

* __featuretovector.py__:
save all features in a list

* __feature_selection.py__:
reduce the number of features

* __machine_learning.py__:
train models and get results

This tool uses k-fold cross validation to divide the original data into a training set and a test set. The final result is the average of all models.

## Usage

1. Create a new folder called "__DataSet__", then create two subfolders called "__benign__" and "__malware__", put benign apks into "benign" and the malware apks into "malware".

2. Run __apktomatrix.py__ and __featurevector.py__ to serialize the data.

3.  Run __feature_selection.py__ (reduced to 500 features by default).

4. Run __machine_learning.py__ to get final result. The result includes the accuracy, precision, recall of the classifier trained by each classification algorithm.
